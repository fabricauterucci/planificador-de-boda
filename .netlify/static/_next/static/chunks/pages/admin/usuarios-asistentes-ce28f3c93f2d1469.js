(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[939],{6379:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var a=s(7876),r=s(4232),d=s(2982),n=s(806),l=s(7896);function i(){let{token:e,role:t,authLoading:s}=(0,n.A)(),[i,c]=(0,r.useState)([]),[o,m]=(0,r.useState)(!0),[x,h]=(0,r.useState)(null);return((0,r.useEffect)(()=>{async function e(){m(!0),h(null);try{let{data:e,error:t}=await d.N.from("rsvp").select("user_id, asistencia, menu, comentario, created_at").eq("asistencia","asistire");if(t)throw t;let s=e.map(e=>e.user_id),a=[];if(s.length>0){let{data:e}=await d.N.from("users").select("id, nombre, rol").in("id",s);a=e||[]}let r=e.map(e=>{let t=a.find(t=>t.id===e.user_id);return{...e,nombre:(null==t?void 0:t.nombre)||e.user_id,rol:(null==t?void 0:t.rol)||""}});c(r)}catch(e){h(e.message)}finally{m(!1)}}"admin"!==t||s||e()},[t,s]),s)?(0,a.jsx)("div",{children:"Cargando..."}):"admin"!==t?(0,a.jsx)("div",{children:"No autorizado"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.A,{}),(0,a.jsxs)("main",{className:"pt-24 max-w-2xl mx-auto p-4",children:[(0,a.jsx)("h1",{className:"font-display text-2xl mb-6",children:"Usuarios que van a asistir"}),o&&(0,a.jsx)("div",{children:"Cargando asistentes..."}),x&&(0,a.jsxs)("div",{className:"text-red-600",children:["Error: ",x]}),!o&&0===i.length&&(0,a.jsx)("div",{children:"No hay asistentes confirmados."}),!o&&i.length>0&&(0,a.jsxs)("table",{className:"w-full border mt-4",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-dusk text-white",children:[(0,a.jsx)("th",{className:"p-2",children:"Nombre"}),(0,a.jsx)("th",{className:"p-2",children:"Rol"}),(0,a.jsx)("th",{className:"p-2",children:"Men\xfa"}),(0,a.jsx)("th",{className:"p-2",children:"Comentario"}),(0,a.jsx)("th",{className:"p-2",children:"Fecha"})]})}),(0,a.jsx)("tbody",{children:i.map(e=>(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("td",{className:"p-2",children:e.nombre}),(0,a.jsx)("td",{className:"p-2",children:e.rol}),(0,a.jsx)("td",{className:"p-2",children:e.menu}),(0,a.jsx)("td",{className:"p-2",children:e.comentario}),(0,a.jsx)("td",{className:"p-2",children:e.created_at?new Date(e.created_at).toLocaleString():""})]},e.user_id))})]})]})]})}},7048:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/usuarios-asistentes",function(){return s(6379)}])},7896:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var a=s(7876),r=s(8230),d=s.n(r),n=s(806),l=s(4232);function i(){let{token:e,role:t,authLoading:s,logout:r}=(0,n.A)(),[i,c]=(0,l.useState)("");return(0,l.useEffect)(()=>{{c(localStorage.getItem("name")||"");let e=()=>c(localStorage.getItem("name")||"");return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)}},[]),(0,l.useEffect)(()=>{c(localStorage.getItem("name")||"")},[e]),(0,a.jsx)("header",{className:"fixed top-0 inset-x-0 z-50",children:(0,a.jsxs)("nav",{className:"mx-auto max-w-6xl flex items-center justify-between p-4 md:p-6",children:[(0,a.jsx)(d(),{href:"/",className:"font-display text-xl md:text-2xl",children:"Sof\xeda & Franco"}),(0,a.jsxs)("div",{className:"flex flex-row gap-2 md:gap-4 items-center min-w-[140px] w-auto flex-nowrap",children:[!s&&"admin"!==t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d(),{href:"/rsvp",className:"px-3 py-2 md:px-4 md:py-2 rounded-full bg-dusk text-white hover:opacity-90 text-sm md:text-base text-center",children:"Confirmar asistencia"}),(0,a.jsx)(d(),{href:"/menu",className:"px-3 py-2 md:px-4 md:py-2 rounded-full bg-gold text-dusk hover:opacity-90 text-sm md:text-base text-center",children:"Men\xfa"})]}),!s&&("admin"===t||"admin@boda.com"===localStorage.getItem("email"))&&(0,a.jsx)(d(),{href:"/admin/dashboard",className:"px-3 py-2 md:px-4 md:py-2 rounded-full bg-blue-700 text-white hover:opacity-90 text-sm md:text-base text-center",children:"Panel de control"}),!s&&e?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-dusk text-sm font-semibold truncate max-w-[100px]",title:i||t||"Usuario",children:i||t||"Usuario"}),(0,a.jsx)("button",{onClick:r,className:"px-2 py-1 rounded-full bg-blush text-dusk border border-dusk/20 text-xs hover:bg-dusk hover:text-white transition",children:"Cerrar sesi\xf3n"}),("admin"===t||"prometidos"===t||"prometido"===t)&&(0,a.jsx)(d(),{href:"/debug",className:"px-2 py-1 rounded-full bg-gray-200 text-dusk border border-dusk/20 text-xs hover:bg-dusk hover:text-white transition",children:"Debug"})]}):(0,a.jsx)(d(),{href:"/login",className:"px-3 py-2 md:px-4 md:py-2 rounded-full bg-white border border-dusk/20 hover:bg-blush text-sm md:text-base text-center",children:"Login"})]})]})})}}},e=>{e.O(0,[230,636,593,792],()=>e(e.s=7048)),_N_E=e.O()}]);