{"html":"<!DOCTYPE html><html><head><meta charSet=\"utf-8\" data-next-head=\"\"/><meta name=\"viewport\" content=\"width=device-width\" data-next-head=\"\"/><link rel=\"preload\" href=\"/_next/static/css/8bba817502cc81a1.css\" as=\"style\"/><link rel=\"stylesheet\" href=\"/_next/static/css/8bba817502cc81a1.css\" data-n-g=\"\"/><noscript data-n-css=\"\"></noscript><script defer=\"\" nomodule=\"\" src=\"/_next/static/chunks/polyfills-42372ed130431b0a.js\"></script><script src=\"/_next/static/chunks/webpack-c44cf3d39757ced8.js\" defer=\"\"></script><script src=\"/_next/static/chunks/framework-a6e0b7e30f98059a.js\" defer=\"\"></script><script src=\"/_next/static/chunks/main-c35a3a1f6f2b4991.js\" defer=\"\"></script><script src=\"/_next/static/chunks/pages/_app-8b78862bc03dae51.js\" defer=\"\"></script><script src=\"/_next/static/chunks/230-6f6dbb566cd5139b.js\" defer=\"\"></script><script src=\"/_next/static/chunks/pages/admin/fix-policies-f53165aac0fe805f.js\" defer=\"\"></script><script src=\"/_next/static/gaB1F0hWHtcO3UfJO2Wnc/_buildManifest.js\" defer=\"\"></script><script src=\"/_next/static/gaB1F0hWHtcO3UfJO2Wnc/_ssgManifest.js\" defer=\"\"></script></head><body><div id=\"__next\"><header class=\"fixed top-0 inset-x-0 z-50\"><nav class=\"mx-auto max-w-6xl flex items-center justify-between p-4 md:p-6\"><a class=\"font-display text-xl md:text-2xl\" href=\"/\">Sofía &amp; Franco</a><div class=\"flex flex-row gap-2 md:gap-4 items-center min-w-[140px] w-auto flex-nowrap\"><a class=\"px-3 py-2 md:px-4 md:py-2 rounded-full bg-white border border-dusk/20 hover:bg-blush text-sm md:text-base text-center\" href=\"/login\">Login</a></div></nav></header><main class=\"pt-24 max-w-4xl mx-auto p-4\"><h1 class=\"font-display text-2xl mb-6\">Arreglar Políticas de Base de Datos</h1><div class=\"mb-8 p-4 bg-white rounded-lg shadow\"><div class=\"p-4 bg-red-50 border border-red-200 rounded-lg mb-6\"><h2 class=\"font-bold text-lg text-red-700 mb-2\">Error detectado: Recursión infinita</h2><p class=\"text-red-700\">Se ha detectado un error de recursión infinita en las políticas de seguridad de la tabla &quot;users&quot;. Este error ocurre cuando las políticas se referencian a sí mismas de manera circular.</p></div><p class=\"mb-4\">Esta herramienta te ayudará a corregir el problema generando un script SQL que puedes ejecutar en Supabase.</p><button class=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\">Generar Script de Corrección</button><div class=\"mt-6 border-t pt-4\"><h3 class=\"font-bold mb-2\">Explicación detallada del error:</h3><p class=\"mb-2\">El error &quot;infinite recursion detected in policy for relation &#x27;users&#x27;&quot; ocurre cuando una política de seguridad en Supabase hace referencia a sí misma de manera circular. Específicamente:</p><ul class=\"list-disc ml-6 mt-2 space-y-1\"><li>Cuando una política que controla el acceso a la tabla &quot;users&quot; incluye una condición que necesita consultar la misma tabla &quot;users&quot;</li><li>Por ejemplo, si tienes una política que dice &quot;un usuario puede editar registros si su rol es admin&quot;, pero para verificar el rol necesitas consultar la tabla users</li><li>Esto crea un bucle infinito: para verificar si puede acceder a users, necesita acceder a users, lo que requiere verificar si puede acceder a users, y así sucesivamente</li></ul><p class=\"mt-2\">La solución implementada evita esta recursión utilizando directamente atributos del token JWT (como el email) en lugar de consultar la tabla para verificar roles. De esta manera, la verificación de permisos no necesita consultar la tabla &quot;users&quot; y se rompe el ciclo.</p></div></div></main></div><script id=\"__NEXT_DATA__\" type=\"application/json\">{\"props\":{\"pageProps\":{}},\"page\":\"/admin/fix-policies\",\"query\":{},\"buildId\":\"gaB1F0hWHtcO3UfJO2Wnc\",\"nextExport\":true,\"autoExport\":true,\"isFallback\":false,\"scriptLoader\":[]}</script></body></html>","isFullyStaticPage":true}